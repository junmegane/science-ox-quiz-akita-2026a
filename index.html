<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ç†ç§‘ â—‹Ã—ã‚¯ã‚¤ã‚º</title>

  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }

    button {
      font-size: 18px;
      margin: 10px;
      padding: 10px 20px;
      cursor: pointer;
    }

    .hidden {
      display: none;
    }

    .review {
      text-align: left;
      max-width: 800px;
      margin: auto;
    }

    hr {
      margin: 20px 0;
    }

    /* ===== å›ºå®šãƒŠãƒ“ãƒœã‚¿ãƒ³ ===== */
    #nav {
      position: fixed;
      top: 15px;
      right: 15px;
      z-index: 1000;
    }

    #nav a {
      display: inline-block;
      padding: 10px 16px;
      background: #1976d2;
      color: white;
      text-decoration: none;
      font-weight: bold;
      border-radius: 20px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.2);
    }

    #nav a:hover {
      background: #125aa0;
    }
  </style>
</head>

<body>

<!-- ğŸ”µ å›ºå®šãƒœã‚¿ãƒ³ -->
<div id="nav">
  <a href="https://akirunogiga-my.sharepoint.com/:x:/g/personal/t000739_akiruno_ed_jp/IQBtHG2Xj_tyT5O0MtOLIzJBAaUx8pOJMzsN1oorCxWfj_g?e=1IR6sm" target="_blank">
    â—‹Ã—å•é¡Œä¸€è¦§
  </a>
</div>

<h1>ç†ç§‘ â—‹Ã—ã‚¯ã‚¤ã‚º</h1>

<div id="loading">èª­ã¿è¾¼ã¿ä¸­...</div>

<div id="quiz" class="hidden">
  <h2 id="question"></h2>
  <button onclick="answer('â—‹')">â—‹</button>
  <button onclick="answer('Ã—')">Ã—</button>
</div>

<div id="explanation" class="hidden">
  <h3 id="result"></h3>
  <p id="comment"></p>
  <button onclick="nextQuestion()">æ¬¡ã®å•é¡Œã¸</button>
</div>

<div id="resultScreen" class="hidden">
  <h2 id="score"></h2>
  <button onclick="restart()">ğŸ” ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦</button>
  <button onclick="showReview()">ğŸ“˜ è§£ç­”æŒ¯ã‚Šè¿”ã‚Š</button>
</div>

<div id="reviewScreen" class="hidden">
  <h2>è§£ç­”æŒ¯ã‚Šè¿”ã‚Š</h2>
  <div id="reviewList" class="review"></div>
  <button onclick="restart()">ğŸ” å†æŒ‘æˆ¦</button>
</div>

<script>
let questions = [];
let quiz = [];
let current = 0;
let score = 0;
let history = [];

fetch("questions.csv")
  .then(res => res.text())
  .then(text => {
    const lines = text.trim().split("\n").slice(1);
    questions = lines.map(line => {
      const [q, a, c] = line.split(",");
      return { q, a: a.trim(), c };
    });
    startQuiz();
  })
  .catch(() => {
    document.getElementById("loading").innerText = "èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ";
  });

function startQuiz() {
  quiz = questions.sort(() => Math.random() - 0.5).slice(0, 10);
  current = 0;
  score = 0;
  history = [];
  document.getElementById("loading").classList.add("hidden");
  document.getElementById("resultScreen").classList.add("hidden");
  document.getElementById("reviewScreen").classList.add("hidden");
  showQuestion();
}

function showQuestion() {
  document.getElementById("quiz").classList.remove("hidden");
  document.getElementById("explanation").classList.add("hidden");
  document.getElementById("question").innerText = quiz[current].q;
}

function answer(ans) {
  const q = quiz[current];
  const correct = ans === q.a;
  if (correct) score++;

  history.push({
    question: q.q,
    your: ans,
    correct: q.a,
    comment: q.c
  });

  document.getElementById("quiz").classList.add("hidden");
  document.getElementById("explanation").classList.remove("hidden");
  document.getElementById("result").innerText = correct ? "â­• æ­£è§£ï¼" : "âŒ ä¸æ­£è§£";
  document.getElementById("comment").innerText = q.c;
}

function nextQuestion() {
  current++;
  if (current < quiz.length) {
    showQuestion();
  } else {
    showResult();
  }
}

function showResult() {
  document.getElementById("explanation").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");
  document.getElementById("score").innerText = `10å•ä¸­ ${score} å• æ­£è§£ï¼`;
}

function restart() {
  startQuiz();
}

function showReview() {
  document.getElementById("resultScreen").classList.add("hidden");
  document.getElementById("reviewScreen").classList.remove("hidden");

  const list = document.getElementById("reviewList");
  list.innerHTML = "";

  history.forEach((h, i) => {
    list.innerHTML += `
      <p>
        <strong>Q${i + 1}ï¼š</strong>${h.question}<br>
        ã‚ãªãŸã®ç­”ãˆï¼š${h.your}<br>
        æ­£è§£ï¼š${h.correct}<br>
        è§£èª¬ï¼š${h.comment}
      </p>
      <hr>
    `;
  });
}
</script>

</body>
</html>

